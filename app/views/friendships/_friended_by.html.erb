<% if current_user.friended_by.count >= 1 %>

  <h4 class="text-center"> These friends have shared their gift list with you: </h4>
  <!--   The loop generates a list of who the current user is a "buddy" of. Each item (called "friend") in the loop below is someone who has shared their list with the current user.
   -->  
  <table class = 'table'>
    <% current_user.friended_by.each do |friend| %>
      <tr>
        <td><h5><%= link_to "#{friend.name}", profile_user_path(friend) %></h5></td>
        <td>
          <% my_friendships = Friendship.where(buddy_id=current_user.id) %>
          <!--   my_friendships is an array of all the all of the friendships where a user shared their gift list with the current user. -->
          <% friendship = my_friendships.where(user_id=friend.id).first %>
          <%= link_to [friendship], method: :delete, class: 'btn btn-sm btn-danger' do %><i class="glyphicon glyphicon-remove"> </i>&nbsp; Remove
          <% end %>
        </td>  
      </tr>
    <% end %>

  </table>

<% end %>